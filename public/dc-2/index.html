<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    	<link rel="stylesheet" type="text/css" href="bootstrap.min.css"/>
		<script type="text/javascript" src="d3.v2.js"></script>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="sgatools.graphics.js"></script>
		<script type="text/javascript" src="bootstrap.min.js"></script>
		
		<script type="text/javascript" src="color_picker/jquery.miniColors.js"></script>
		<link type="text/css" rel="stylesheet" href="color_picker/jquery.miniColors.css" />
	</head>
	
	<body>
		<div class="container" style="width:1000px">
		<div class="well" style="margin-top:20px">
			<h4>Options:</h4>
			<select id="dataCombobox">
			</select>
			<div class="btn-group" style="display:inline">
                <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown">Export heatmap <span class="caret"></span></button>
                <ul class="dropdown-menu">
                	<li><a href="#">Export as SVG</a></li>
                	<li><a href="#">Export as PNG</a></li>
                	<li><a href="#">Export as PDF</a></li>
                </ul>
            </div>
            
            
            <div class="input-prepend input-append pull-left">
			  <span class="add-on">Low</span>
			  <input class="span2" id="appendedPrependedInput" type="text" style="height:30px; width:50px; text-align:center;" placeholder="-1">
			  <span class="add-on"><input type="hidden" id="colorLow" class="color-picker miniColors" size="7" autocomplete="off" value="#FF0000" maxlength="7"></span>
			</div>
            
             <div class="input-prepend input-append pull-left">
			  <span class="add-on">Med</span>
			  <input class="span2" id="appendedPrependedInput" type="text" style="height:30px; width:50px; text-align:center;" placeholder="0">
			  <span class="add-on"><input type="hidden" id="colorMed" class="color-picker miniColors" size="7" autocomplete="off" value="#000000" maxlength="7"></span>
			</div>
			
			<div class="input-prepend input-append pull-left">
			  <span class="add-on">High</span>
			  <input class="span2" id="appendedPrependedInput" type="text" style="height:30px; width:50px; text-align:center;" placeholder="1">
			  <span class="add-on">
			  	<input type="hidden" id="colorHigh" class="color-picker miniColors" size="7" autocomplete="off" value="#008000" maxlength="7"></span>
			</div>
            
            
		</div>
		
		<div class="tabbable tabs-left"> <!-- Only required for left/right tabs -->
			<ul class="nav nav-tabs">
				<li class="active"><a href="#heatmap" data-toggle="tab">Heatmap</a></li>
				<li><a href="#histogram" data-toggle="tab">Histogram</a></li>
				<li><a href="#funcenrich" data-toggle="tab">Functional enrichment</a></li>
				<li><a href="#network" data-toggle="tab">Interaction network</a></li>
			</ul>
			<div class="tab-content">
				<div class="tab-pane active" id="heatmap">
					
				</div>
				<div class="tab-pane" id="histogram">
					<p>Histogram here</p>
				</div>
				<div class="tab-pane" id="funcenrich">
					<p>Functional enrichment: export to g:Profiler?</p>
					<iframe style="width:800px; height:600px" src='http://biit.cs.ut.ee/gprofiler/index.cgi?organism=scerevisiae&query=swi4+swi6+mbp1+mcm1+fkh1+fkh2+ndd1+swi5+ace2&r_chr=X&r_start=start&r_end=end&analytical=1&domain_size_type=annotated&term=&significant=1&sort_by_structure=1&user_thr=1.00&output=png&prefix=ENTREZGENE_ACC'>
					</iframe>
				</div>
				<div class="tab-pane" id="network">
					<p>Cytoscape JS network</p>
				</div>
			</div>
		</div>
		â€‹
		<script type="text/javascript" src="sgatools.heatmap.js"></script>
		
		<script type="text/javascript">
		
			var colorLow = $('#colorLow').val()
			var colorMed = $('#colorMed').val()
			var colorHigh = $('#colorHigh').val()
			
			$(".color-picker").miniColors({
			    change: function(hex, rgb) { 
			    	colorLow = $('#colorLow').val()
					colorMed = $('#colorMed').val()
					colorHigh = $('#colorHigh').val()
					redrawHeatmap();
			    	
			    }
			});
			redrawHeatmap();
			function redrawHeatmap(){
				drawHeatmap({
					heatmapContainer : '#heatmap',
					dataPath : 'data/sgadata1-real.csv',
					gridSize : 15,
					colorLow: colorLow,
					colorMed: colorMed, 
					colorHigh: colorHigh
				})
			}
			
			
			
			dataPaths = ['data/sgadata1-real.csv', 'data/sgadata2.csv', 'data/sgadata3.csv']
			
			jQuery.each(dataPaths, function() {
		    	$('#dataCombobox').append('<option>'+this+'</option>');
		    });
		    $('#dataCombobox').change(function() {
				drawHeatmap({
					heatmapContainer : '#heatmap',
					dataPath :  $('#dataCombobox').val(),
					gridSize : 15
				})
			});
			
		</script>
	</body>
</html>